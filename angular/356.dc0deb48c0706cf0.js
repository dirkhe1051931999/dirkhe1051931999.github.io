"use strict";(self.webpackChunkangular_admin_template=self.webpackChunkangular_admin_template||[]).push([[356],{1356:(e,n,s)=>{s.r(n),s.d(n,{PermissionsModule:()=>w});var i=s(6189),t=s(4521),r=s(2411),o=s(7579),u=s(2722),c=s(5e3),g=s(1235),m=s(2368),l=s(3075),d=s(9832),p=s(9808);function a(e,n){if(1&e&&(c.TgZ(0,"mat-button-toggle",6),c._uU(1),c.qZA()),2&e){const e=n.$implicit;c.Q6J("value",e.key),c.xp6(1),c.Oqu(e.key)}}function h(e,n){1&e&&(c.TgZ(0,"div"),c._uU(1,"只有'ADMIN', 'GUEST2'才能看到"),c.qZA())}function x(e,n){1&e&&(c.TgZ(0,"div"),c._uU(1,"除了 MANAGER 都能看到"),c.qZA())}const Z=function(){return["ADMIN","GUEST2"]},P=function(){return["MANAGER"]};let _=(()=>{class e{constructor(e,n,s,i){this.rolesService=e,this.permissionsSrv=n,this.roleService=s,this.router=i,this.toggleChecked=!1,this._destroy$=new o.x,this.permissionsOfRole=s.permissionsOfRole}ngOnInit(){this.currentRole=Object.keys(this.rolesService.getRoles())[0],this.currentPermissions=Object.keys(this.permissionsSrv.getPermissions()),this.rolesService.roles$.pipe((0,u.R)(this._destroy$)).subscribe((e=>{})),this.permissionsSrv.permissions$.pipe((0,u.R)(this._destroy$)).subscribe((e=>{}))}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}onPermissionChange(){this.currentPermissions=this.permissionsOfRole[this.currentRole],this.rolesService.flushRolesAndPermissions(),this.rolesService.addRoleWithPermissions(this.currentRole,this.currentPermissions),this.toggleChecked&&this.router.navigateByUrl("/dashboard")}}return e.ɵfac=function(n){return new(n||e)(c.Y36(g.cM),c.Y36(g.YI),c.Y36(r.Nj),c.Y36(t.F0))},e.ɵcmp=c.Xpm({type:e,selectors:[["app-permissions-role-switching"]],decls:18,vars:15,consts:[[1,"m-b-16"],[3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[4,"ngxPermissionsOnly"],[4,"ngxPermissionsExcept"],[3,"value"]],template:function(e,n){1&e&&(c.TgZ(0,"div",0)(1,"mat-slide-toggle",1),c.NdJ("ngModelChange",(function(e){return n.toggleChecked=e})),c._uU(2,"是否切换路由后跳转到dashboard "),c.qZA()(),c.TgZ(3,"mat-button-toggle-group",2),c.NdJ("ngModelChange",(function(e){return n.currentRole=e}))("change",(function(){return n.onPermissionChange()})),c.YNc(4,a,2,2,"mat-button-toggle",3),c.ALo(5,"keyvalue"),c.qZA(),c.TgZ(6,"p"),c._uU(7," 当前角色: "),c.TgZ(8,"code"),c._uU(9),c.ALo(10,"json"),c.qZA()(),c.TgZ(11,"p"),c._uU(12," 当前权限: "),c.TgZ(13,"code"),c._uU(14),c.ALo(15,"json"),c.qZA()(),c.YNc(16,h,2,0,"div",4),c.YNc(17,x,2,0,"div",5)),2&e&&(c.xp6(1),c.Q6J("ngModel",n.toggleChecked),c.xp6(2),c.Q6J("ngModel",n.currentRole),c.xp6(1),c.Q6J("ngForOf",c.lcZ(5,7,n.permissionsOfRole)),c.xp6(5),c.Oqu(c.lcZ(10,9,n.currentRole)),c.xp6(5),c.Oqu(c.lcZ(15,11,n.currentPermissions)),c.xp6(2),c.Q6J("ngxPermissionsOnly",c.DdM(13,Z)),c.xp6(1),c.Q6J("ngxPermissionsExcept",c.DdM(14,P)))},directives:[m.Rr,l.JJ,l.On,d.A9,p.sg,d.Yi,g.gE],pipes:[p.Nd,p.Ts],styles:[""]}),e})();function U(e,n){1&e&&(c.TgZ(0,"p",10),c._uU(1,"只有权限canRead才能看到"),c.qZA())}function f(e,n){1&e&&(c.TgZ(0,"p",10),c._uU(1,"只有权限canRead才能看到"),c.qZA())}function A(e,n){1&e&&(c.TgZ(0,"p",10),c._uU(1,"只有权限admin才能看到"),c.qZA())}function b(e,n){1&e&&(c.TgZ(0,"p",10),c._uU(1,"只有权限admin才能看到"),c.qZA())}function y(e,n){1&e&&(c.TgZ(0,"p",11),c._uU(1,"只有权限guest才能看到"),c.qZA())}function T(e,n){1&e&&(c.TgZ(0,"p",12),c._uU(1,"除了权限ok外能看到"),c.qZA())}function v(e,n){1&e&&(c.TgZ(0,"div"),c._uU(1,"仅有admin吗？是-》a，否-》b"),c.qZA())}function O(e,n){1&e&&(c.TgZ(0,"div"),c._uU(1,"除了admin吗？是-》a，否->b"),c.qZA())}function N(e,n){1&e&&(c.TgZ(0,"p",13),c._uU(1,"else a"),c.qZA())}function k(e,n){1&e&&(c.TgZ(0,"p",14),c._uU(1,"then: b"),c.qZA())}const q=function(){return["canRead"]},J=function(){return["admin"]},M=function(){return["guest"]},E=function(){return["ok"]};let R=(()=>{class e{constructor(e){this.permissionsSrv=e,this.comparedPermission=["guest"]}ngOnInit(){}getPermissions(){return Object.keys(this.permissionsSrv.getPermissions())}addPermission(e){this.permissionsSrv.addPermission(e,(()=>new Promise(((e,n)=>{setTimeout((()=>e(!0)),2e3)}))))}removePermission(e){this.permissionsSrv.removePermission(e)}unAuthorized(){}authorized(){}changeToAdmin(){this.comparedPermission=["admin"]}changeToAnotherPermission(){this.comparedPermission=["awesome"]}changeToGuest(){this.comparedPermission=["guest"]}}return e.ɵfac=function(n){return new(n||e)(c.Y36(g.YI))},e.ɵcmp=c.Xpm({type:e,selectors:[["app-permissions-test"]],decls:56,vars:24,consts:[[3,"click"],[3,"ngxPermissionsOnly"],["class","bg-green-500 text-white",4,"ngxPermissionsOnly"],["permissions","",3,"ngxPermissionsOnly"],[3,"ngxPermissionsOnly","ngxPermissionsExcept"],["permissions","",3,"ngxPermissionsExcept","permissionsAuthorized","permissionsUnauthorized"],[4,"ngxPermissionsOnly","ngxPermissionsOnlyElse","ngxPermissionsOnlyThen"],[4,"ngxPermissionsExcept","ngxPermissionsExceptElse","ngxPermissionsExceptThen"],["a",""],["b",""],[1,"bg-green-500","text-white"],[1,"bg-purple-500","text-white"],[1,"bg-orange-500","text-white"],[1,"bg-gray-900","text-white"],[1,"bg-gray-300"]],template:function(e,n){if(1&e&&(c._uU(0,"ngxPermissionsOnly,ngxPermissionsExcept 如果是内置标签，要以[]形式使用，如果是html标签，要以*使用\n"),c.TgZ(1,"p")(2,"button",0),c.NdJ("click",(function(){return n.addPermission("admin")})),c._uU(3,"添加权限 [ admin ]"),c.qZA(),c.TgZ(4,"button",0),c.NdJ("click",(function(){return n.addPermission("guest")})),c._uU(5,"添加权限 [ guest ]"),c.qZA(),c.TgZ(6,"button",0),c.NdJ("click",(function(){return n.addPermission("ok")})),c._uU(7,"添加权限 [ ok ]"),c.qZA(),c.TgZ(8,"button",0),c.NdJ("click",(function(){return n.removePermission("admin")})),c._uU(9,"移除权限 [ admin ]"),c.qZA(),c.TgZ(10,"button",0),c.NdJ("click",(function(){return n.removePermission("guest")})),c._uU(11,"移除权限 [ guest ]"),c.qZA(),c.TgZ(12,"button",0),c.NdJ("click",(function(){return n.removePermission("ok")})),c._uU(13,"移除权限 [ ok ]"),c.qZA()(),c._UZ(14,"br"),c._uU(15,"-----------------------只有权限canRead才能看到 start"),c._UZ(16,"br"),c.YNc(17,U,2,0,"ng-template",1),c.YNc(18,f,2,0,"p",2),c._uU(19,"\n----------------------- end"),c._UZ(20,"br")(21,"br"),c._uU(22,"-----------------------只有权限admin才能看到-----------------------start"),c._UZ(23,"br"),c.YNc(24,A,2,0,"ng-template",3),c.YNc(25,b,2,0,"ng-template",4),c._uU(26,"\n----------------------- end "),c._UZ(27,"br")(28,"br"),c._uU(29,"-----------------------只有权限guest才能看到----------------------- start"),c._UZ(30,"br"),c.YNc(31,y,2,0,"ng-template",3),c._uU(32,"\n----------------------- end "),c._UZ(33,"br")(34,"br"),c._uU(35,"-----------------------除了权限ok外能看到----------------------- start"),c._UZ(36,"br"),c.YNc(37,T,2,0,"ng-template",5),c.NdJ("permissionsAuthorized",(function(){return n.authorized()}))("permissionsUnauthorized",(function(){return n.unAuthorized()})),c._uU(38,"\n----------------------- end"),c._UZ(39,"br")(40,"br"),c._uU(41,"----------------------- else then 的用法-----------------------start"),c._UZ(42,"br"),c.YNc(43,v,2,0,"div",6),c.YNc(44,O,2,0,"div",7),c.YNc(45,N,2,0,"ng-template",null,8,c.W1O),c.YNc(47,k,2,0,"ng-template",null,9,c.W1O),c._uU(49,"\n----------------------- end"),c._UZ(50,"br"),c.TgZ(51,"p"),c._uU(52," 当前权限： "),c.TgZ(53,"code"),c._uU(54),c.ALo(55,"json"),c.qZA()()),2&e){const e=c.MAs(46),s=c.MAs(48);c.xp6(17),c.Q6J("ngxPermissionsOnly",c.DdM(16,q)),c.xp6(1),c.Q6J("ngxPermissionsOnly",c.DdM(17,q)),c.xp6(6),c.Q6J("ngxPermissionsOnly",c.DdM(18,J)),c.xp6(1),c.Q6J("ngxPermissionsOnly",c.DdM(19,J))("ngxPermissionsExcept","hhhhh"),c.xp6(6),c.Q6J("ngxPermissionsOnly",c.DdM(20,M)),c.xp6(6),c.Q6J("ngxPermissionsExcept",c.DdM(21,E)),c.xp6(6),c.Q6J("ngxPermissionsOnly",c.DdM(22,J))("ngxPermissionsOnlyElse",e)("ngxPermissionsOnlyThen",s),c.xp6(1),c.Q6J("ngxPermissionsExcept",c.DdM(23,J))("ngxPermissionsExceptElse",e)("ngxPermissionsExceptThen",s),c.xp6(10),c.Oqu(c.lcZ(55,14,n.getPermissions()))}},directives:[g.gE],pipes:[p.Ts],styles:[""]}),e})();const Y=[{path:"role-switching",component:_},{path:"test",component:R,canActivate:[g.DD],data:{permissions:{only:"ADMIN",redirectTo:"/dashboard"}}}];let S=(()=>{class e{}return e.ɵfac=function(n){return new(n||e)},e.ɵmod=c.oAB({type:e}),e.ɵinj=c.cJS({imports:[[t.Bz.forChild(Y)],t.Bz]}),e})();let w=(()=>{class e{}return e.ɵfac=function(n){return new(n||e)},e.ɵmod=c.oAB({type:e}),e.ɵinj=c.cJS({imports:[[i.m,S]]}),e})()}}]);